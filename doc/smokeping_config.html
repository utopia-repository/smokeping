<HTML>
<HEAD>
<TITLE>smokeping_config</TITLE>
<LINK REV="made" HREF="mailto:karrer@iis.ee.ethz.ch">
</HEAD>

<BODY>

<A NAME="__index__"></A>
<!-- INDEX BEGIN -->
<!--

<UL>

	<LI><A HREF="#overview">OVERVIEW</A></LI>
	<LI><A HREF="#reference">REFERENCE</A></LI>
	<UL>

		<LI><A HREF="#*** general *** (mandatory section)">*** General *** <EM>(mandatory section)</EM></A></LI>
		<LI><A HREF="#*** database *** (mandatory section)">*** Database *** <EM>(mandatory section)</EM></A></LI>
		<LI><A HREF="#*** presentation *** (mandatory section)">*** Presentation *** <EM>(mandatory section)</EM></A></LI>
		<LI><A HREF="#*** probes *** (mandatory section)">*** Probes *** <EM>(mandatory section)</EM></A></LI>
		<LI><A HREF="#*** targets *** (mandatory section)">*** Targets *** <EM>(mandatory section)</EM></A></LI>
	</UL>

	<LI><A HREF="#copyright">COPYRIGHT</A></LI>
	<LI><A HREF="#license">LICENSE</A></LI>
	<LI><A HREF="#author">AUTHOR</A></LI>
</UL>
-->
<!-- INDEX END -->

<P>
<H1><A NAME="overview">OVERVIEW</A></H1>
<P>SmokePing takes its configuration from a single central configuration file.
Its location must be hardcoded in the smokeping script and smokeping.cgi.</P>
<P>The contents of this manual is generated directly from the configuration
file parser.</P>
<P>The Parser for the Configuration file is written using David Schweikers
ParseConfig module. Read all about it in <A HREF="./ISG/ParseConfig.html">the ISG::ParseConfig manpage</A>.</P>
<P>The Configuration file has a tree-like structure with section headings at
various levels. It also contains variable assignements and tables.</P>
<P>
<HR>
<H1><A NAME="reference">REFERENCE</A></H1>
<P>The text below describes the syntax of the SmokePing configuration file.</P>
<P>
<H2><A NAME="*** general *** (mandatory section)">*** General *** <EM>(mandatory section)</EM></A></H2>
<P>General configuration values valid for the whole SmokePing setup.</P>
<P>The following variables can be set in this section:</P>
<DL>
<DT><STRONG><A NAME="item_owner"><STRONG>owner</STRONG> <EM>(mandatory setting)</EM></A></STRONG><BR>
<DD>
Name of the person responsible for this smokeping installation.
<P></P>
<DT><STRONG><A NAME="item_imgcache"><STRONG>imgcache</STRONG> <EM>(mandatory setting)</EM></A></STRONG><BR>
<DD>
A directory which is visible on your webserver where SmokePing can cache graphs.
<P></P>
<DT><STRONG><A NAME="item_imgurl"><STRONG>imgurl</STRONG> <EM>(mandatory setting)</EM></A></STRONG><BR>
<DD>
Either an absolute URL to the <STRONG>imgcache</STRONG> directory or one relative to the directory where you keep the
SmokePing cgi.
<P></P>
<DT><STRONG><A NAME="item_datadir"><STRONG>datadir</STRONG> <EM>(mandatory setting)</EM></A></STRONG><BR>
<DD>
The directory where SmokePing can keep its rrd files.
<P></P>
<DT><STRONG><A NAME="item_piddir"><STRONG>piddir</STRONG> <EM>(mandatory setting)</EM></A></STRONG><BR>
<DD>
The directory where SmokePing keeps its pid when demonised.
<P></P>
<DT><STRONG><A NAME="item_sendmail"><STRONG>sendmail</STRONG></A></STRONG><BR>
<DD>
Path to your sendmail binary. It will be used for sending mails in connection with the support of DYNAMIC addresses.
<P></P>
<DT><STRONG><A NAME="item_smokemail"><STRONG>smokemail</STRONG> <EM>(mandatory setting)</EM></A></STRONG><BR>
<DD>
Path to the mail template for DYNAMIC hosts. This mail template
must contain keywords of the form <STRONG>&lt;##</STRONG><EM>keyword</EM><STRONG>##&gt;</STRONG>. There is a sample
template included with SmokePing.
<P></P>
<DT><STRONG><A NAME="item_cgiurl"><STRONG>cgiurl</STRONG> <EM>(mandatory setting)</EM></A></STRONG><BR>
<DD>
Complete URL path of the SmokePing.cgi
<P></P>
<DT><STRONG><A NAME="item_mailhost"><STRONG>mailhost</STRONG></A></STRONG><BR>
<DD>
Instead of using sendmail, you can specify the name of an smtp server 
and use perl's Net::SMTP module to send mail to DYNAMIC host owners (see below).
<P></P>
<DT><STRONG><A NAME="item_contact"><STRONG>contact</STRONG> <EM>(mandatory setting)</EM></A></STRONG><BR>
<DD>
Mail address of the person responsible for this smokeping installation.
<P></P></DL>
<P>
<H2><A NAME="*** database *** (mandatory section)">*** Database *** <EM>(mandatory section)</EM></A></H2>
<P>Describes the properties of the round robin database for storing the
SmokePing data. Note that it is not possible to edit existing RRDs
by changeing the entries in the cfg file.</P>
<P>The following variables can be set in this section:</P>
<DL>
<DT><STRONG><A NAME="item_step"><STRONG>step</STRONG> <EM>(mandatory setting)</EM></A></STRONG><BR>
<DD>
Duration of the base operation interval of SmokePing in seconds.
SmokePing will venture out every <STRONG>step</STRONG> seconds to ping your target hosts.
<P></P>
<DT><STRONG><A NAME="item_pings"><STRONG>pings</STRONG> <EM>(mandatory setting)</EM></A></STRONG><BR>
<DD>
How many pings should be sent to each target. Suggested: 20 pings.
<P></P></DL>
<P>This section also contains a table describing the setup of the
SmokePing database. Below are reasonable defaults. Only change them if
you know rrdtool and its workings. Each row in the table describes one RRA.</P>
<PRE>
 # cons   xff steps rows
 AVERAGE  0.5   1   1008
 AVERAGE  0.5  12   4320
     MIN  0.5  12   4320
     MAX  0.5  12   4320
 AVERAGE  0.5 144    720
     MAX  0.5 144    720
     MIN  0.5 144    720</PRE>
<DL>
<DT><STRONG><A NAME="item_column">column 0</A></STRONG><BR>
<DD>
Consolidation method.
<P></P>
<DT><STRONG>column 1</STRONG><BR>
<DD>
What part of the consolidated intervals must be known to warrant a known entry.
<P></P>
<DT><STRONG>column 2</STRONG><BR>
<DD>
How many <STRONG>steps</STRONG> to consolidate into for each RRA entry.
<P></P>
<DT><STRONG>column 3</STRONG><BR>
<DD>
How many <STRONG>rows</STRONG> this RRA should have.
<P></P></DL>
<P>
<H2><A NAME="*** presentation *** (mandatory section)">*** Presentation *** <EM>(mandatory section)</EM></A></H2>
<P>Defines how the SmokePing data should be presented.</P>
<P>The following variables can be set in this section:</P>
<DL>
<DT><STRONG><A NAME="item_template"><STRONG>template</STRONG> <EM>(mandatory setting)</EM></A></STRONG><BR>
<DD>
The webpage template must contain keywords of the form 
<STRONG>&lt;##</STRONG><EM>keyword</EM><STRONG>##&gt;</STRONG>. There is a sample
template included with SmokePing; use it as the basis for your
experiments. Default template contains a pointer to the SmokePing
counter and homepage. I would be glad if you would not remove this as
it gives me an indication as to how widely used the tool is.
<P></P>
<DT><STRONG><A NAME="item_charset"><STRONG>charset</STRONG></A></STRONG><BR>
<DD>
By default, SmokePing assumes the 'iso-8859-15' character set. If you use
something else, this is the place to speak up.
<P></P></DL>
<P>The following sections are valid on level 1:</P>
<DL>
<DT><STRONG><A NAME="item_overview"><STRONG>+overview</STRONG> <EM>(mandatory section)</EM></A></STRONG><BR>
<DD>
The Overview section defines how the Overview graphs should look.
<P>The following variables can be set in this section:</P>
<DL>
<DT><STRONG><A NAME="item_width"><STRONG>width</STRONG> <EM>(mandatory setting)</EM></A></STRONG><BR>
<DD>
Width of the Overview Graphs.
<P></P>
<DT><STRONG><A NAME="item_height"><STRONG>height</STRONG> <EM>(mandatory setting)</EM></A></STRONG><BR>
<DD>
Height of the Overview Graphs.
<P></P>
<DT><STRONG><A NAME="item_range"><STRONG>range</STRONG></A></STRONG><BR>
<DD>
How much time should be depicted in the Overview graph. Time must be specified
as a number followed by a letter which specifies the unit of time. Known units are:
<STRONG>s</STRONG>econds, <STRONG>m</STRONG>inutes, <STRONG>h</STRONG>ours, <STRONG>d</STRONG>days, <STRONG>w</STRONG>eeks, <STRONG>y</STRONG>ears.
<P></P>
<DT><STRONG><A NAME="item_max_rtt"><STRONG>max_rtt</STRONG></A></STRONG><BR>
<DD>
Any roundtrip time larger than this value will cropped in the overview graph
<P></P>
<DT><STRONG><A NAME="item_median_color"><STRONG>median_color</STRONG></A></STRONG><BR>
<DD>
By default the median line is drawn in red. Override it here with a hex color
in the format <EM>rrggbb</EM>.
<P></P>
<DT><STRONG><A NAME="item_strftime"><STRONG>strftime</STRONG></A></STRONG><BR>
<DD>
Use posix strftime to format the timestamp in the left hand
lower corner of the overview graph
<P></P></DL>
<DT><STRONG><A NAME="item_detail"><STRONG>+detail</STRONG> <EM>(mandatory section)</EM></A></STRONG><BR>
<DD>
The following variables can be set in this section:
<DL>
<DT><STRONG><STRONG>width</STRONG> <EM>(mandatory setting)</EM></STRONG><BR>
<DD>
How many pixels wide should detail graphs be
<P></P>
<DT><STRONG><STRONG>height</STRONG> <EM>(mandatory setting)</EM></STRONG><BR>
<DD>
How many pixels high should detail graphs be
<P></P>
<DT><STRONG><A NAME="item_logarithmic"><STRONG>logarithmic</STRONG></A></STRONG><BR>
<DD>
should the graphs be shown in a logarithmic scale (yes/no)
<P></P>
<DT><STRONG><A NAME="item_unison_tolerance"><STRONG>unison_tolerance</STRONG></A></STRONG><BR>
<DD>
if a graph is more than this factor of the median 'max' it drops out of the unison scaling algorithm. A factor of two would mean that any graph with a max either less than half or more than twice the median 'max' will be dropped from unison scaling
<P></P>
<DT><STRONG><STRONG>max_rtt</STRONG></STRONG><BR>
<DD>
Any roundtrip time larger than this value will cropped in the detail graph
<P></P>
<DT><STRONG><STRONG>strftime</STRONG></STRONG><BR>
<DD>
Use posix strftime to format the timestamp in the left hand
lower corner of the detail graph
<P></P></DL>
<P>The detailed display can contain several graphs of different resolution. In this
table you can specify the resolution of each graph.</P>
<P>Example:</P>
<PRE>
 &quot;Last 3 Hours&quot;    3h
 &quot;Last 30 Hours&quot;   30h
 &quot;Last 10 Days&quot;    10d
 &quot;Last 400 Days&quot;   400d</PRE>
<DL>
<DT><STRONG>column 0</STRONG><BR>
<DD>
Description of the particular resolution.
<P></P>
<DT><STRONG>column 1</STRONG><BR>
<DD>
How much time should be depicted. The format is the same as for the <STRONG>age</STRONG>  parameter of the Overview section.
<P></P></DL>
<P>The following sections are valid on level 2:</P>
<DL>
<DT><STRONG><A NAME="item_%2B%2Bloss_colors"><STRONG>++loss_colors</STRONG></A></STRONG><BR>
<DD>
In the Detail view, the color of the median line depends
the amount of lost packets. SmokePing comes with a reasonable default setting,
but you may choose to disagree. The table below
lets you specify your own coloring.
<P>Example:</P>
<PRE>
 Loss Color   Legend
 1    00ff00    &quot;&lt;1&quot;
 3    0000ff    &quot;&lt;3&quot;
 1000 ff0000    &quot;&gt;=3&quot;</PRE>
<DL>
<DT><STRONG>column 0</STRONG><BR>
<DD>
Activate when the lossrate is larger of equal to this number
<P></P>
<DT><STRONG>column 1</STRONG><BR>
<DD>
Color for this range.
<P></P>
<DT><STRONG>column 2</STRONG><BR>
<DD>
Description for this range.
<P></P></DL>
<DT><STRONG><A NAME="item_%2B%2Buptime_colors"><STRONG>++uptime_colors</STRONG></A></STRONG><BR>
<DD>
When monitoring a host with DYNAMIC addressing, SmokePing will keep track of how long
the machine is able to keep the same IP address. This time is plotted as a color
in the graphs background. SmokePing comes with a reasonable default setting,
but you may choose to disagree. The table below
lets you specify your own coloring
<P>Example:</P>
<PRE>
 Uptime Color     Legend
 3600    00ff00   &quot;&lt;1h&quot;
 86400   0000ff   &quot;&lt;1d&quot;
 604800  ff0000   &quot;&lt;1w&quot;
 1000000000000 ffff00   &quot;&gt;1w&quot;</PRE>
<P>Uptime is in days!</P>
<DL>
<DT><STRONG>column 0</STRONG><BR>
<DD>
Activate when uptime in days is larger of equal to this number
<P></P>
<DT><STRONG>column 1</STRONG><BR>
<DD>
Color for this uptime range range.
<P></P>
<DT><STRONG>column 2</STRONG><BR>
<DD>
Description for this range.
<P></P></DL>
</DL>
</DL>
<P>
<H2><A NAME="*** probes *** (mandatory section)">*** Probes *** <EM>(mandatory section)</EM></A></H2>
<P>The Probes Section configures Probe modules. Probe modules integrate an external ping command into SmokePing. Check the documentation of the Ping module for configuration details.</P>
<P>The following sections are valid on level 1:</P>
<DL>
<DT><STRONG><A NAME="item_%2B%2F%5B%2D_0%2D9a%2DzA%2DZ%5D%2B%2F"><STRONG>+/[-_0-9a-zA-Z]+/</STRONG></A></STRONG><BR>
<DD>
Each module can take specific configuration information from this area. The jumble of letters above is a regular expression defining legal module names.
<P>The following variables can be set in this section:</P>
<DL>
<DT><STRONG><A NAME="item_%2F%5B%2D_0%2D9a%2DzA%2DZ%5D%2B%2F"><STRONG>/[-_0-9a-zA-Z]+/</STRONG></A></STRONG><BR>
<DD>
Each module defines which
variables it wants to accept. So this expression here just defines legal variable names.
<P></P></DL>
</DL>
<P>
<H2><A NAME="*** targets *** (mandatory section)">*** Targets *** <EM>(mandatory section)</EM></A></H2>
<P>The Target Section defines the actual work of SmokePing. It contains a hierarchical list
of hosts which mark the endpoints of the network connections the system should monitor.
Each section can contain one host as well as other sections.</P>
<P>The following variables can be set in this section:</P>
<DL>
<DT><STRONG><A NAME="item_probe"><STRONG>probe</STRONG> <EM>(mandatory setting)</EM></A></STRONG><BR>
<DD>
The name of the probe module to be used for this host. The value of
this variable gets propagated
<P></P>
<DT><STRONG><A NAME="item_menu"><STRONG>menu</STRONG> <EM>(mandatory setting)</EM></A></STRONG><BR>
<DD>
Menu entry for this section
<P></P>
<DT><STRONG><A NAME="item_title"><STRONG>title</STRONG> <EM>(mandatory setting)</EM></A></STRONG><BR>
<DD>
Title of the page when it is displayed.
<P></P>
<DT><STRONG><A NAME="item_remark"><STRONG>remark</STRONG></A></STRONG><BR>
<DD>
An optional remark on the current section. It gets displayed on the webpage.
<P></P></DL>
<P>The following sections are valid on level 1:</P>
<DL>
<DT><STRONG><A NAME="item_%2BPROBE_CONF"><STRONG>+PROBE_CONF</STRONG></A></STRONG><BR>
<DD>
Probe specific variables.
<P>The following variables can be set in this section:</P>
<DL>
<DT><STRONG><STRONG>/[-_0-9a-zA-Z]+/</STRONG></STRONG><BR>
<DD>
Should be found in the documentation of the
corresponding probe. The values get propagated. If a child
node uses the same Probe as the parent.
<P></P></DL>
<DT><STRONG><STRONG>+/[-_0-9a-zA-Z]+/</STRONG></STRONG><BR>
<DD>
Each target section can contain information about a host to monitor as
well as further target sections. Most variables have already been
described above. The expression above defines legal names for target
sections.
<P>The following variables can be set in this section:</P>
<DL>
<DT><STRONG><STRONG>probe</STRONG></STRONG><BR>
<DD>
<DT><STRONG><STRONG>menu</STRONG> <EM>(mandatory setting)</EM></STRONG><BR>
<DD>
<DT><STRONG><STRONG>title</STRONG> <EM>(mandatory setting)</EM></STRONG><BR>
<DD>
<DT><STRONG><A NAME="item_note"><STRONG>note</STRONG></A></STRONG><BR>
<DD>
Some information about this entry which does NOT get displayed on the web.
<P></P>
<DT><STRONG><A NAME="item_email"><STRONG>email</STRONG></A></STRONG><BR>
<DD>
This is the contact address for the owner of the current host. In connection with the <STRONG>DYNAMIC</STRONG> hosts,
the address will be used for sending the belowmentioned script.
<P></P>
<DT><STRONG><A NAME="item_host"><STRONG>host</STRONG></A></STRONG><BR>
<DD>
Can either contain the name of a target host or the string <STRONG>DYNAMIC</STRONG>.
<P>In the second case, the target machine has a dynamic IP address and
thus is required to regularly contact the SmokePing server to verify
its IP address.  When starting SmokePing with the commandline argument
<STRONG>--email</STRONG> it will add a secret password to each of the <STRONG>DYNAMIC</STRONG>
host lines and send a script to the owner of each host. This script
must be started regularly on the host in question to make sure
SmokePing monitors the right box. If the target machine supports
SNMP SmokePing will also query the hosts
sysContact, sysName and sysLocation properties to make sure it is
still the same host.</P>
<P></P>
<DT><STRONG><STRONG>remark</STRONG></STRONG><BR>
<DD>
</DL>
<P>The following sections are valid on level 2:</P>
<DL>
<DT><STRONG><A NAME="item_%2B%2BPROBE_CONF"><STRONG>++PROBE_CONF</STRONG></A></STRONG><BR>
<DD>
Probe specific variables.
<P>The following variables can be set in this section:</P>
<DL>
<DT><STRONG><STRONG>/[-_0-9a-zA-Z]+/</STRONG></STRONG><BR>
<DD>
Should be found in the documentation of the
corresponding probe. The values get propagated. If a child
node uses the same Probe as the parent.
<P></P></DL>
<DT><STRONG><A NAME="item_%2B%2B%2F%5B%2D_0%2D9a%2DzA%2DZ%5D%2B%2F"><STRONG>++/[-_0-9a-zA-Z]+/</STRONG></A></STRONG><BR>
<DD>
Each target section can contain information about a host to monitor as
well as further target sections. Most variables have already been
described above. The expression above defines legal names for target
sections.
<P></P></DL>
</DL>
<P>
<HR>
<H1><A NAME="copyright">COPYRIGHT</A></H1>
<P>Copyright (c) 2001 by Tobias Oetiker. All right reserved.</P>
<P>
<HR>
<H1><A NAME="license">LICENSE</A></H1>
<P>This program is free software; you can redistribute it
and/or modify it under the terms of the GNU General Public
License as published by the Free Software Foundation; either
version 2 of the License, or (at your option) any later
version.</P>
<P>This program is distributed in the hope that it will be
useful, but WITHOUT ANY WARRANTY; without even the implied
warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
PURPOSE.  See the GNU General Public License for more
details.</P>
<P>You should have received a copy of the GNU General Public
License along with this program; if not, write to the Free
Software Foundation, Inc., 675 Mass Ave, Cambridge, MA
02139, USA.</P>
<P>
<HR>
<H1><A NAME="author">AUTHOR</A></H1>
<P>Tobias Oetiker &lt;<A HREF="mailto:tobi@oetiker.ch">tobi@oetiker.ch</A>&gt;</P>

</BODY>

</HTML>
