<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>smokeping_examples</title>
<link rev="made" href="mailto:root@localhost" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->
<!--

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#overview">OVERVIEW</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<ul>

		<li><a href="#example_1__config_simple">Example 1: config.simple</a></li>
		<li><a href="#example_2__config_multipleprobes">Example 2: config.multiple-probes</a></li>
		<li><a href="#example_3__config_fpinginstances">Example 3: config.fping-instances</a></li>
		<li><a href="#example_4__config_targetvarswithcurl">Example 4: config.targetvars-with-Curl</a></li>
		<li><a href="#example_5__config_echoping">Example 5: config.echoping</a></li>
		<li><a href="#example_6__config_template">Example 6: config.template</a></li>
	</ul>

	<li><a href="#copyright">COPYRIGHT</a></li>
	<li><a href="#license">LICENSE</a></li>
	<li><a href="#author">AUTHOR</a></li>
	<li><a href="#see_also">SEE ALSO</a></li>
</ul>
-->
<!-- INDEX END -->

<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>smokeping_examples - Examples of Smokeping configuration</p>
<p>
</p>
<hr />
<h1><a name="overview">OVERVIEW</a></h1>
<p>This document provides some examples of Smokeping configuration files.
All the examples can be found in the <code>examples</code> directory in the
Smokeping documentation. Note that the DNS names in the examples are
non-functional.</p>
<p>Details of the syntax and all the variables are found in 
<a href="././smokeping_config.html">the smokeping_config manpage</a> and in the documentation of the
corresponding probe, if applicable.</p>
<p>This manual is automatically generated from the Smokeping source code,
specifically the <a href="././Smokeping/Examples.html">Smokeping::Examples</a> module.</p>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>Currently the examples differ only in the <code>Probes</code> and <code>Targets</code>
sections. The other sections are taken from the <code>etc/config.dist</code>
configuration template in the Smokeping distribution so that the example
files are complete.</p>
<p>If you would like to provide more examples, document the other sections
or enhance the existing examples, please do so, preferably by sending
the proposed changes to the smokeping-users mailing list.</p>
<p>
</p>
<h2><a name="example_1__config_simple">Example 1: config.simple</a></h2>
<dl>
<dt><strong><a name="item_probe_configuration">Probe configuration</a></strong><br />

</dt><dd>
<pre>
 *** Probes ***
 +FPing
 binary = /usr/bin/fping</pre>

</dd><dt><strong><a name="item_probe_explanation">Probe explanation</a></strong><br />

</dt><dd>
Here we have just one probe, fping, pinging four hosts.

</dd><dd>
<p>The fping probe is using the default parameters, some of them supplied
from the Database section (``step'' and ``pings''), and some of them by
the probe module.</p>

<p></p>
</dd><dt><strong><a name="item_target_configuration">Target configuration</a></strong><br />

</dt><dd>
<pre>
 *** Targets ***
 probe = FPing
 
 menu = Top
 title = Network Latency Grapher
 remark = Welcome to this SmokePing website.
 
 + mysite1
 menu = Site 1
 title = Hosts in Site 1
 
 ++ myhost1
 host = myhost1.mysite1.example
 ++ myhost2
 host = myhost2.mysite1.example
 
 + mysite2
 menu = Site 2
 title = Hosts in Site 2
 
 ++ myhost3
 host = myhost3.mysite2.example
 ++ myhost4
 host = myhost4.mysite2.example</pre>

</dd><dt><strong><a name="item_target_explanation">Target explanation</a></strong><br />

</dt><dd>
The hosts are located in two sites of two hosts each, and the
configuration has been divided to site sections ('+') and host subsections
('++') accordingly.

<p></p></dd></dl>
<p>
</p>
<h2><a name="example_2__config_multipleprobes">Example 2: config.multiple-probes</a></h2>
<dl>
<dt><strong>Probe configuration</strong><br />

</dt><dd>
<pre>
 *** Probes ***
 + FPing
 binary = /usr/bin/fping
 packetsize = 1000
 
 + DNS
 binary = /usr/bin/dig
 lookup = name.example
 pings = 5
 step = 180
 
 + EchoPingHttp
 pings = 5
 url = /test-url</pre>

</dd><dt><strong>Probe explanation</strong><br />

</dt><dd>
Here we have three probes: FPing for the regular ICMP pings,
DNS for name server latency measurement and EchoPingHttp
for web servers.

</dd><dd>
<p>The FPing probe runs with the default parameters, except that the ICMP
packet size is 1000 bytes instead of the default 56 bytes.</p>

</dd><dd>
<p>The DNS and EchoPingHttp probes have been configured to be a bit more
gentle with the servers, as they only do 5 queries (pings) instead of the
default 20 (or whatever is specified in the Database section). However,
DNS queries are made more often: 5 queries every 3 minutes instead of
every 5 minutes.</p>

<p></p>
</dd><dt><strong>Target configuration</strong><br />

</dt><dd>
<pre>
 *** Targets ***
 probe = FPing
 menu = Top
 title = Network Latency Grapher
 remark = Welcome to this SmokePing website.
 
 + network
 menu = Net latency
 title = Network latency (ICMP pings)
 
 ++ myhost1
 host = myhost1.example
 ++ myhost2
 host = myhost2.example
 
 + services
 menu = Service latency
 title = Service latency (DNS, HTTP)
 
 ++ DNS
 probe = DNS
 menu = DNS latency
 title = Service latency (DNS)
 
 +++ dns1
 host = dns1.example
 
 +++ dns2
 host = dns2.example
 
 ++ HTTP
 menu = HTTP latency
 title = Service latency (HTTP)
 
 +++ www1
 host = www1.example
 
 +++ www2
 host = www2.example</pre>

</dd><dt><strong>Target explanation</strong><br />

</dt><dd>
The target tree has been divided by the probe used. This does not have
to be the case: every target (sub)section can use a different probe,
and the same probe can be used in different parts of the config tree.

<p></p></dd></dl>
<p>
</p>
<h2><a name="example_3__config_fpinginstances">Example 3: config.fping-instances</a></h2>
<dl>
<dt><strong>Probe configuration</strong><br />

</dt><dd>
<pre>
 *** Probes ***
 + FPing
 binary = /usr/bin/fping
 
 ++ FPingNormal
 offset = 0%
 
 ++ FPingLarge
 packetsize = 5000
 offset = 50%</pre>

</dd><dt><strong>Probe explanation</strong><br />

</dt><dd>
This example demonstrates the concept of probe instances. The FPingLarge
and FPingNormal probes are independent of each other, they just use
the same module, FPing. FPingNormal uses the default parameters, and
so does FPingLarge except for the 5 kilobyte packetsize. Both use the
same fping binary, and its path is configured FPing top section.

</dd><dd>
<p>The 'offset' parameters make sure the probes don't run at the same time -
FPingNormal is run every 'full' 5 minutes (eg. 8:00, 8:05, 8:10 and so on,
in wallclock time) while FPingLarge is run halfway through these intervals
(eg. 8:02:30, 8:07:30 etc.)</p>

</dd><dd>
<p>The top FPing section does not define a probe in itself because it
has subsections. If we really wanted to have one probe named ``FPing'',
we could do so by making a subsection by that name.</p>

<p></p>
</dd><dt><strong>Target configuration</strong><br />

</dt><dd>
<pre>
 *** Targets ***
 probe = FPingNormal
 menu = Top
 title = Network Latency Grapher
 remark = Welcome to this SmokePing website.
 
 + network
 menu = Net latency
 title = Network latency (ICMP pings)
 
 ++ myhost1
 menu = myhost1
 title = ICMP latency for myhost1
 
 +++ normal
 title = Normal packetsize (56 bytes)
 probe = FPingNormal
 host = myhost1.example
 
 +++ large
 title = Large packetsize (5000 bytes)
 probe = FPingLarge
 host = myhost1.example
 
 ++ myhost2
 menu = myhost2
 title = ICMP latency for myhost2
 
 +++ normal
 title = Normal packetsize (56 bytes)
 probe = FPingNormal
 host = myhost2.example
 
 +++ large
 title = Large packetsize (5000 bytes)
 probe = FPingLarge
 host = myhost2.example</pre>

</dd><dt><strong>Target explanation</strong><br />

</dt><dd>
The target section shows two host, myhost1.example and myhost2.example,
being pinged with two differently sized ICMP packets. This time the tree
is divided by the target host rather than the probe.

<p></p></dd></dl>
<p>
</p>
<h2><a name="example_4__config_targetvarswithcurl">Example 4: config.targetvars-with-Curl</a></h2>
<dl>
<dt><strong>Probe configuration</strong><br />

</dt><dd>
<pre>
 *** Probes ***
 + Curl
 # probe-specific variables
 binary = /usr/bin/curl
 step = 60
 
 # a default for this target-specific variable
 urlformat = <a href="http://%host/">http://%host/</a></pre>

</dd><dt><strong>Probe explanation</strong><br />

</dt><dd>
This example explains the difference between probe- and target-specific
variables. We use the Curl probe for this.

</dd><dd>
<p>Every probe supports at least some probe-specific variables. The values
of these variables are common to all the targets of the probe, and
they can only be configured in the Probes section. In this case, 
the probe-specific variables are ``binary'' and ``step''.</p>

</dd><dd>
<p>Target-specific variables are supported by most probes, the most notable
exception being the FPing probe and its derivatives. Target-specific
variables can have different values for different targets. They can be
configured in both Probes and Targets sections. The values assigned in the
Probes section function become default values that can be overridden
in the Targets section.</p>

</dd><dd>
<p>The documentation of each probe states which of its variables are
probe-specific and which are target-specific.</p>

</dd><dd>
<p>In this case the ``urlformat'' variable is a target-specific one.  It is
also quite uncommon, because it can contain a placeholder for the ``host''
variable in the Targets section. This is not a general feature, its
usage is only limited to the ``urlformat'' variable and the ``%host%'' escape.</p>

</dd><dd>
<p>(The reason why the FPing probe does not support target-specific variables
is simply the fact that the fping program measures all its targets in one
go, so they all have the same parameters. The other probes ping their targets
one at a time.)</p>

<p></p>
</dd><dt><strong>Target configuration</strong><br />

</dt><dd>
<pre>
 *** Targets ***
 probe = Curl
 menu = Top
 title = Network Latency Grapher
 remark = Welcome to this SmokePing website.
 
 + HTTP
 menu = http
 title = HTTP latency 
 
 ++ myhost1
 menu = myhost1
 title = HTTP latency for myhost1
 host = myhost1.example
 
 ++ myhost2
 menu = myhost2
 title = HTTP latency for myhost2
 host = myhost2.example
 
 ++ myhost3
 menu = myhost3
 title = HTTP latency for myhost3 (port 8080!)
 host = myhost3.example
 urlformat = <a href="http://%host%:8080/">http://%host%:8080/</a>
 
 + FTP
 menu = ftp
 title = FTP latency
 urlformat = <a href="ftp://%host%/">ftp://%host%/</a>
 
 ++ myhost1
 menu = myhost1
 title = FTP latency for myhost1
 host = myhost1.example
 
 ++ myhost2
 menu = myhost2
 title = FTP latency for myhost2
 host = myhost2.example</pre>

</dd><dt><strong>Target explanation</strong><br />

</dt><dd>
The target tree is divided into an HTTP branch and an FTP one.
The servers ``myhost1.example'' and ``myhost2.example'' are probed
in both. The third server, ``myhost3.example'', only has an HTTP
server, and it's in a non-standard port (8080).

</dd><dd>
<p>The ``urlformat'' variable is specified for the whole FTP branch
as ``ftp://%host%/''. For the HTTP branch, the default from the
Probes section is used, except for myhost3, which overrides
it to tag the port number into the URL.</p>

</dd><dd>
<p>The myhost3 assignment could just as well have included the hostname
verbatim (ie. urlformat = <a href="http://myhost3.example:8080/)">http://myhost3.example:8080/)</a> instead of
using the %host% placeholder, but the host variable would still have
been required (even though it wouldn't have been used for anything).</p>

<p></p></dd></dl>
<p>
</p>
<h2><a name="example_5__config_echoping">Example 5: config.echoping</a></h2>
<dl>
<dt><strong>Probe configuration</strong><br />

</dt><dd>
<pre>
 *** Probes ***
 + FPing
 binary = /usr/bin/fping
 
 # these expect to find echoping in /usr/bin
 # if not, you'll have to specify the location separately for each probe
 # + EchoPing         # uses TCP or UDP echo (port 7)
 # + EchoPingDiscard  # uses TCP or UDP discard (port 9)
 # + EchoPingChargen  # uses TCP chargen (port 19)
 + EchoPingSmtp       # SMTP (25/tcp) for mail servers
 + EchoPingHttps      # HTTPS (443/tcp) for web servers
 + EchoPingHttp       # HTTP (80/tcp) for web servers and caches
 + EchoPingIcp        # ICP (3130/udp) for caches</pre>

</dd><dt><strong>Probe explanation</strong><br />

</dt><dd>
This example shows most of the echoping-derived probes in action.

<p></p>
</dd><dt><strong>Target configuration</strong><br />

</dt><dd>
<pre>
 *** Targets ***
 # default probe
 probe = FPing
 
 menu = Top
 title = Network Latency Grapher
 remark = Welcome to this SmokePing website.
 
 + MyServers
 
 menu = My Servers
 title = My Servers 
 
 ++ www-server
 menu = www-server
 title = Web Server (www-server) / ICMP
 # probe = FPing propagated from top
 host = www-server.example
 
 +++ http
 menu = http
 title = Web Server (www-server) / HTTP
 probe = EchoPingHttp
 host = www-server.example 
 # default url is /
 
 +++ https
 menu = https
 title = Web Server (www-server) / HTTPS
 probe = EchoPingHttps
 host = www-server.example
 
 ++ cache
 menu = www-cache
 title = Web Cache (www-cache) / ICMP
 host = www-cache.example
 
 +++ http
 menu = http
 title = www-cache / HTTP
 probe = EchoPingHttp
 host = www-cache.example
 port = 8080 # use the squid port
 url = <a href="http://www.somehost.example/">http://www.somehost.example/</a>
 
 +++ icp
 menu = icp
 title = www-cache / ICP
 probe = EchoPingIcp
 host = www-cache.example
 url = <a href="http://www.somehost.example/">http://www.somehost.example/</a>
 
 ++ mail
 menu = mail-server
 title = Mail Server (mail-server) / ICMP
 host = mail-server.example
 
 +++ smtp
 menu = mail-server / SMTP
 title = Mail Server (mail-server) / SMTP
 probe = EchoPingSmtp
 host = mail-server.example</pre>

</dd><dt><strong>Target explanation</strong><br />

</dt><dd>
All the servers are pinged both with ICMP (the FPing probe)
and their respective echoping probe. The proxy server, www-cache,
is probed with both HTTP requests and ICP requests for the same
URL.

<p></p></dd></dl>
<p>
</p>
<h2><a name="example_6__config_template">Example 6: config.template</a></h2>
<dl>
<dt><strong>Probe configuration</strong><br />

</dt><dd>
<pre>
 *** Probes ***
 
 + FPing
 
 binary = /usr/bin/fping</pre>

</dd><dt><strong>Probe explanation</strong><br />

</dt><dd>
This is the template configuration file distributed with Smokeping.
It is included in the examples as well for the sake of completeness.

<p></p>
</dd><dt><strong>Target configuration</strong><br />

</dt><dd>
<pre>
 *** Targets ***
 
 probe = FPing
 
 ## You have to edit and uncomment all what you want below this.
 # Please, refer to smokeping_config man page for more info
 # The given adresses aren't real to avoid DoS.
 
 menu = Top
 title = Network Latency Grapher
 remark = Welcome to the SmokePing website of 'A poorly \
        mantained site running Debian.'
 
 + Local
 
 menu = Local
 title = Local Network
 
 ++ LocalMachine
 
 menu = Local Machine
 title = This own machine
 host = localhost
 
 + World
 
 menu = World
 title = Worldwide Connectivity
 
 ++ Europe
 
 menu = Europe
 title =European Connectivity
 
 +++ Switzerland
 
 menu = Switzerland
 title =Swiss Connectivity
 alerts = bigloss,someloss,startloss
 
 # ++++ SBB
 #
 # menu = SBB/CFF/FFS
 # title =Swiss Federal Railways Webserver
 # host = www.railway-server.abc
 
 
 # ++++ Tiscali
 #
 # menu = Tiscali Web
 # title = Tiscali Webserver www.tiscali.abc
 # host = www.tiscali-web.abc
 
 +++ UK
 
 menu = United Kingdom
 title = United Kingdom
 
 # ++++ UCL
 #
 # menu = UCL
 # title = UCL
 # host = www.ucl-abc.acc.uk
 
 ++ USA
 
 menu = North America
 title =North American Connectivity
 
 # +++ MIT
 
 # menu = MIT
 # title = Massachusetts Institute of Technology Webserver
 # host = www.gurkoman.ybc
 
 # +++ IU
 # 
 # menu = IU
 # title = Indiana University
 # host = www.iu.ali
 
 # +++ UCB
 #
 # menu = U. C. Berkeley
 # title = U. C. Berkeley Webserver
 # host = www.berkly.udi
 
 # +++ UCSD
 #
 # menu = U. C. San Diego
 # title = U. C. San Diego Webserver
 # host = www.ucsdddar.art
 
 # +++ Sun
 #
 # menu = Sun Microsystems
 # title = Sun Microsystems Webserver
 # host = www.sun-web.com</pre>

</dd><dt><strong>Target explanation</strong><br />

</dt><dd>
This is the template configuration file distributed with Smokeping.
It is included in the examples as well for the sake of completeness.

<p></p></dd></dl>
<p>
</p>
<hr />
<h1><a name="copyright">COPYRIGHT</a></h1>
<p>Copyright 2005 by Niko Tyni.</p>
<p>
</p>
<hr />
<h1><a name="license">LICENSE</a></h1>
<p>This program is free software; you can redistribute it
and/or modify it under the terms of the GNU General Public
License as published by the Free Software Foundation; either
version 2 of the License, or (at your option) any later
version.</p>
<p>This program is distributed in the hope that it will be
useful, but WITHOUT ANY WARRANTY; without even the implied
warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR
PURPOSE.  See the GNU General Public License for more
details.</p>
<p>You should have received a copy of the GNU General Public
License along with this program; if not, write to the Free
Software Foundation, Inc., 675 Mass Ave, Cambridge, MA
02139, USA.</p>
<p>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<p>Niko Tyni &lt;<a href="mailto:ntyni@iki.fi">ntyni@iki.fi</a>&gt;</p>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p>The other Smokeping documents, especially <a href="././smokeping_config.html">the smokeping_config manpage</a>.</p>

</body>

</html>
