.\" Automatically generated by Pod::Man v1.37, Pod::Parser v1.14
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sh \" Subsection heading
.br
.if t .Sp
.ne 5
.PP
\fB\\$1\fR
.PP
..
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  | will give a
.\" real vertical bar.  \*(C+ will give a nicer C++.  Capital omega is used to
.\" do unbreakable dashes and therefore won't be available.  \*(C` and \*(C'
.\" expand to `' in nroff, nothing in troff, for use with C<>.
.tr \(*W-|\(bv\*(Tr
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.Sh), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.if \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.\"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.hy 0
.if n .na
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "probes::CiscoRTTMonTcpConnect 3"
.TH probes::CiscoRTTMonTcpConnect 3 "2005-01-04" "1.35pre1" "SmokePing"
.SH "NAME"
probes::CiscoRTTMonTcpConnect \- Probe for SmokePing
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.Vb 3
\& *** Probes ***
\& + CiscoRTTMonTcpConnect
\& + forks=50
.Ve
.PP
.Vb 11
\& *** Targets ***
\& + MyRouter-TCPVictim
\& menu = MyRouter->TCPVictim
\& title = RTTMon TCP connect from MyRouter to TCPVictim
\& host = TCPVictim.foobar.com.au
\& probe=CiscoRTTMonTcpConnect
\& ++ PROBE_CONF 
\& ioshost = RTTcommunity@Myrouter.foobar.com.au
\& iosint = 10.33.22.11
\& tos = 160
\& port = 23
.Ve
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
A probe for smokeping, which uses the ciscoRttMon \s-1MIB\s0 functionality (\*(L"Service Assurance Agent\*(R", \*(L"\s-1SAA\s0\*(R") of Cisco \s-1IOS\s0 to measure \s-1TCP\s0 connect times between a Cisco router and a \s-1TCP\s0 server. The measured value is the time is the time to establish a \s-1TCP\s0 session, i.e. the time between the initial \*(L"\s-1SYN\s0\*(R" \s-1TCP\s0 packet of the router and the \*(L"\s-1SYN\s0 \s-1ACK\s0\*(R" packet of the host. The router terminates the \s-1TCP\s0 session immediately after the reception of \*(L"\s-1SYN\s0 \s-1ACK\s0\*(R" with a \*(L"\s-1FIN\s0\*(R" packet.
.SH "PARAMETERS"
.IX Header "PARAMETERS"
The (mandatory) host parameter specifies the \s-1IP\s0 host, which the router will connect to. This can be a \s-1DNS\s0 name, the smokeping host can resolve or a dotted-quad \s-1IP\s0 address.
.PP
The (mandatory) ioshost parameter specifies the Cisco router, which will establish the \s-1TCP\s0 connections as well as the \s-1SNMP\s0 community string on the router.
.PP
The (optional) port parameter lets you configure the destination \s-1TCP\s0 port on the host. The default is the http port 80. 
.PP
The (optional) iosint parameter is the source address for the \s-1TCP\s0 connections. This should be one of the active (!) \s-1IP\s0 addresses of the router to get results. \s-1IOS\s0 looks up the target host address in the forwarding table and then uses the interface(s) listed there to send the \s-1TCP\s0 packets. By default \s-1IOS\s0 uses the (primary) \s-1IP\s0 address on the sending interface as source address for a connection. 
.PP
The (optional) tos parameter specifies the value of the ToS byte in the \s-1IP\s0 header of the packets from the router. Multiply \s-1DSCP\s0 values times 4 and Precedence values times 32 to calculate the ToS values to configure, e.g. ToS 160 corresponds to a \s-1DSCP\s0 value 40 and a Precedence value of 5. Please note that this will not influence the ToS value in the packets sent by the the host. 
.SH "IOS VERSIONS"
.IX Header "IOS VERSIONS"
This probe only works with Cisco \s-1IOS\s0 12.0(3)T or higher. It is recommended to test it on less critical routers first. 
.SH "INSTALLATION"
.IX Header "INSTALLATION"
To install this probe copy ciscoRttMonMIB.pm to ($SMOKEPINGINSTALLDIR)/lib and CiscoRTTMonTcpConnect.pm to ($SMOKEPINGINSTALLDIR)/lib/probes. V0.97 or higher of Simon Leinen's SNMP_Session.pm is required.
.PP
The router(s) must be configured to allow read/write \s-1SNMP\s0 access. Sufficient is:
.PP
.Vb 1
\&        snmp-server community RTTCommunity RW
.Ve
.PP
If you want to be a bit more restrictive with \s-1SNMP\s0 write access to the router, then consider configuring something like this 
.PP
.Vb 3
\&        access-list 2 permit 10.37.3.5
\&        snmp-server view RttMon ciscoRttMonMIB included
\&        snmp-server community RTTCommunity view RttMon RW 2
.Ve
.PP
The above configuration grants \s-1SNMP\s0 read-write only to 10.37.3.5 (the smokeping host) and only to the ciscoRttMon \s-1MIB\s0 tree. The probe does not need access to \s-1SNMP\s0 variables outside the RttMon tree.
.SH "BUGS"
.IX Header "BUGS"
The probe establishes unnecessary connections, i.e. more than configured in the \*(L"pings\*(R" variable, because the RTTMon \s-1MIB\s0 only allows to set a total time for all connections in one measurement run (one \*(L"life\*(R"). Currently the probe sets the life duration to \*(L"pings\*(R"*2+3 seconds (2 secs is the timeout value hardcoded into this probe). 
.SH "SEE ALSO"
.IX Header "SEE ALSO"
http://people.ee.ethz.ch/~oetiker/webtools/smokeping/
http://www.switch.ch/misc/leinen/snmp/perl/
.PP
The best source for background info on \s-1SAA\s0 is Cisco's documentation on http://www.cisco.com and the CISCO-RTTMON-MIB documentation, which is available at: 
ftp://ftp.cisco.com/pub/mibs/v2/CISCO\-RTTMON\-MIB.my 
.SH "AUTHOR"
.IX Header "AUTHOR"
Joerg.Kummer at Roche.com 
